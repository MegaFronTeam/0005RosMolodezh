<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="utf-8">
		<title>Дашборды</title>
		<meta name="description" content="о чем страница">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width,initial-scale=1.0,  shrink-to-fit=no, viewport-fit=cover">
		<link type="image/ico" href="img/favicon.ico" rel="shortcut icon"><meta name="format-detection" content="telephone=no"> 
		<link href="libs/swiper/swiper-bundle.min.css" rel="stylesheet"/>
		<link href="libs/@fancyapps/ui/fancybox/fancybox.css" rel="stylesheet"/>
		<link href="libs/select2/css/select2.min.css" rel="stylesheet"/>
		<link href="css/custom-bootstrap.min.css" rel="stylesheet"/>
		<link href="css/main.min.css" rel="stylesheet"/>
		<script>
			function addBlock(elem) {
				fetch(`parts/${elem}.html`)
					.then(response => response.text())
					.then( text => {
						const wrap = document.querySelector(`#${elem}Wrap`);
						wrap.insertAdjacentHTML('afterend', text);
						wrap.previousElementSibling.remove()
						wrap.remove();
					});
			}
		</script>
	</head>
	<body class="main-page">
		<div class="main-wrapper">
			<script>addBlock(`header`)</script>
			<div id="headerWrap"></div>
			<main>
				<div class="container">
					<div class="row row--profile">
						<div class="col-lg-3">
							<!-- start sProfileNav-->
							<section class="sProfileNav section" id="sProfileNav">
								<div class="sProfileNav__top">
									<div class="bagde">ЮРЛИЦО</div>
									<div class="sProfileNav__name">МИНМОЛОДЕЖИ КБР
									</div>
									<div class="sProfileNav__tax-number">ИНН 4569886563
									</div>
									<div class="sProfileNav__action-row">
										<a class="sProfileNav__action-btn" href="#">
											<svg class="icon icon-user ">
												<use xlink:href="img/svg/sprite.svg#user"></use>
											</svg>Профиль
										</a>
										<a class="sProfileNav__action-btn" href="#">
											<svg class="icon icon-redo ">
												<use xlink:href="img/svg/sprite.svg#redo"></use>
											</svg>Обновить
										</a>
									</div>
								</div>
								<nav class="sProfileNav__nav">
									<ul class="sProfileNav__list">
										<li class="sProfileNav__nav-item">
											<a class="sProfileNav__nav-link active" href="#">
												<svg class="icon icon-users ">
													<use xlink:href="img/svg/sprite.svg#users"></use>
												</svg>
												<div class="sProfileNav__nav-title">Сотрудники
												</div>
												<div class="sProfileNav__nav-notice">10
												</div>
											</a>
										</li>
										<li class="sProfileNav__nav-item">
											<a class="sProfileNav__nav-link" href="#">
												<svg class="icon icon-organisation ">
													<use xlink:href="img/svg/sprite.svg#organisation"></use>
												</svg>
												<div class="sProfileNav__nav-title">Организации
												</div>
												<div class="sProfileNav__nav-notice">1
												</div>
											</a>
										</li>
										<li class="sProfileNav__nav-item">
											<a class="sProfileNav__nav-link" href="#">
												<svg class="icon icon-desktop ">
													<use xlink:href="img/svg/sprite.svg#desktop"></use>
												</svg>
												<div class="sProfileNav__nav-title">Формы
												</div>
												<div class="sProfileNav__nav-notice">2
												</div>
											</a>
										</li>
										<li class="sProfileNav__nav-item">
											<a class="sProfileNav__nav-link" href="#">
												<svg class="icon icon-screen ">
													<use xlink:href="img/svg/sprite.svg#screen"></use>
												</svg>
												<div class="sProfileNav__nav-title">Bi аналитика
												</div>
											</a>
										</li>
									</ul>
								</nav>
							</section>
							<!-- end sProfileNav-->
						</div>
						<div class="col-lg-9">
							<!-- start sDashboard-->
							<section class="sDashboard section" id="sDashboard">
								<div class="sDashboard__bg">
									<h5>Динамика общей численности молодежи (14-35 лет)</h5>
									<div class="filter">
										<div class="filter__row row">
											<div class="col-sm-6 col-md-3">
												<div class="filter__item">
													<div class="filter__title">Возраст:
													</div>
													<button class="filter__btn filter__btn--js btn btn-outline-info">Все
													</button>
													<div class="filter__dropdown dropdown visually-hidden">
														<label class="custom-input form-check"><input class="custom-input__input form-check-input filter__checkbox" name="checkbox" type="checkbox"/><span class="custom-input__text form-check-label">Все1</span>
														</label>
														<label class="custom-input form-check"><input class="custom-input__input form-check-input filter__checkbox" name="checkbox" type="checkbox"/><span class="custom-input__text form-check-label">Все2</span>
														</label>
														<label class="custom-input form-check"><input class="custom-input__input form-check-input filter__checkbox" name="checkbox" type="checkbox"/><span class="custom-input__text form-check-label">Все3</span>
														</label>
													</div>
												</div>
											</div>
											<div class="col-sm-6 col-md-3">
												<div class="filter__item">
													<div class="filter__title">Округ:
													</div>
													<button class="filter__btn filter__btn--js btn btn-outline-info">Все
													</button>
													<div class="filter__dropdown dropdown visually-hidden">
														<label class="custom-input form-check"><input class="custom-input__input form-check-input filter__checkbox" name="checkbox" type="checkbox"/><span class="custom-input__text form-check-label">Все1</span>
														</label>
														<label class="custom-input form-check"><input class="custom-input__input form-check-input filter__checkbox" name="checkbox" type="checkbox"/><span class="custom-input__text form-check-label">Все2</span>
														</label>
														<label class="custom-input form-check"><input class="custom-input__input form-check-input filter__checkbox" name="checkbox" type="checkbox"/><span class="custom-input__text form-check-label">Все3</span>
														</label>
													</div>
												</div>
											</div>
											<div class="col-sm-6 col-md-3">
												<div class="filter__item">
													<div class="filter__title">Регион:
													</div>
													<button class="filter__btn filter__btn--js btn btn-outline-info">Выбрано 3
													</button>
													<div class="filter__dropdown dropdown visually-hidden">
														<label class="custom-input form-check"><input class="custom-input__input form-check-input filter__checkbox" name="checkbox" type="checkbox"/><span class="custom-input__text form-check-label">Все1</span>
														</label>
														<label class="custom-input form-check"><input class="custom-input__input form-check-input filter__checkbox" name="checkbox" type="checkbox"/><span class="custom-input__text form-check-label">Все2</span>
														</label>
														<label class="custom-input form-check"><input class="custom-input__input form-check-input filter__checkbox" name="checkbox" type="checkbox"/><span class="custom-input__text form-check-label">Все3</span>
														</label>
													</div>
												</div>
											</div>
											<div class="col-sm-6 col-md-3">
												<div class="filter__item">
													<div class="filter__title">Год:
													</div>
													<button class="filter__btn filter__btn--js btn btn-outline-info">Все
													</button>
													<div class="filter__dropdown dropdown visually-hidden">
														<label class="custom-input form-check"><input class="custom-input__input form-check-input filter__checkbox" name="checkbox" type="checkbox"/><span class="custom-input__text form-check-label">Все1</span>
														</label>
														<label class="custom-input form-check"><input class="custom-input__input form-check-input filter__checkbox" name="checkbox" type="checkbox"/><span class="custom-input__text form-check-label">Все2</span>
														</label>
														<label class="custom-input form-check"><input class="custom-input__input form-check-input filter__checkbox" name="checkbox" type="checkbox"/><span class="custom-input__text form-check-label">Все3</span>
														</label>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div class="sDashboard__chart-wrap">
										<canvas id="myChart"></canvas>
									</div>
								</div>
								<h5 class="mb-4">По Российской Федерации</h5>
								<div class="sDashboard__row row">
									<div class="sDashboard__col col-xl-3 col-md-4 col-sm-6">
										<div class="sDashboard__item">
											<div class="sDashboard__item-title fw-300">2021
											</div>
											<div class="sDashboard__item-count h5 mb-0">37 565 568 чел. 
											</div>
										</div>
									</div>
									<div class="sDashboard__col col-xl-3 col-md-4 col-sm-6">
										<div class="sDashboard__item">
											<div class="sDashboard__item-title fw-300">2022
											</div>
											<div class="sDashboard__item-count h5 mb-0">37 565 568 чел. 
											</div>
										</div>
									</div>
									<div class="sDashboard__col col-xl-3 col-md-4 col-sm-6">
										<div class="sDashboard__item">
											<div class="sDashboard__item-title fw-300">2023
											</div>
											<div class="sDashboard__item-count h5 mb-0">37 565 568 чел. 
											</div>
										</div>
									</div>
									<div class="sDashboard__col col-xl-3 col-md-4 col-sm-6">
										<div class="sDashboard__item">
											<div class="sDashboard__item-title fw-300">2024
											</div>
											<div class="sDashboard__item-count h5 mb-0">37 565 568 чел. 
											</div>
										</div>
									</div>
								</div>
							</section>
							<!-- end sDashboard-->
						</div>
					</div>
				</div>
			</main>
			<script>addBlock(`footer`)</script>
			<div id="footerWrap"></div>
		</div>
		<script src="libs/jquery/jquery.min.js"></script>
		<script src="libs/@fancyapps/ui/fancybox/fancybox.umd.js"> </script>
		<script src="libs/swiper/swiper-bundle.min.js"> </script>
		<script src="libs/inputmask/inputmask.min.js"> </script>
		<script src="libs/select2/js/select2.full.min.js"></script>
		<script src="libs/select2/js/i18n/ru.js"></script>
		<script src="js/read-more.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<script src="js/JSCCommon.js"></script>
		<script src="js/common.js"></script>
		<script>
			document.addEventListener('DOMContentLoaded', function () {
				const fileUploads = document.querySelectorAll('.file-container--js');
			
				if (fileUploads.length) {
					fileUploads.forEach((element) => {
						const fileInput = element.querySelector('.file-upload');
						const fileNameElement = element.querySelector('.file-name');
						const fileInfo = element.querySelector('.file-info');
						const removeFileElement = element.querySelector('.remove-file');
						const fileLabel = element.querySelector('.file-label');
			
						fileInfo.style.display = 'none';
						removeFileElement.style.display = 'none';
			
						fileInput.addEventListener('change', () => {
							const file = fileInput.files[0];
							if (file) {
								fileNameElement.textContent = file.name;
								fileInfo.style.display = 'inline-block';
								removeFileElement.style.display = 'inline-block';
								fileLabel.style.display = 'none';
							}
						});
			
						removeFileElement.addEventListener('click', () => {
							fileInput.value = '';
							fileNameElement.textContent = '';
							fileInfo.style.display = 'none';
							removeFileElement.style.display = 'none';
							fileLabel.style.display = 'inline-block';
						});
					});
				}
			
				const labels = ['ДФО', 'ПФО', 'СЗФО', 'СКФО', 'СФО', 'УФО', 'ЦФО', 'ЮФО'];
			
				const data = {
					labels: labels,
					datasets: [
						{
							label: '2022',
							data: [3256889, 3256889, 3256889, 3256889, 3562998, 3256889, 3256889, 3256889],
							backgroundColor: '#9c4dcc',
						},
						{
							label: '2023',
							data: [3256889, 3256889, 3256889, 3256889, 3256889, 3256889, 3256889, 3256889],
							backgroundColor: '#a866d6',
						},
						{
							label: '2024',
							data: [3256889, 3256889, 3256889, 3256889, 3256889, 3256889, 3256889, 3256889],
							backgroundColor: '#b87de0',
						},
					],
				};
			
				// Плагин для подписей сверху и снизу
				const topBottomLabelsPlugin = {
					id: 'topBottomLabels',
					afterDatasetsDraw(chart) {
						const { ctx } = chart;
						chart.data.datasets.forEach((dataset, datasetIndex) => {
							const meta = chart.getDatasetMeta(datasetIndex);
							meta.data.forEach((bar, index) => {
								const value = dataset.data[index].toLocaleString('ru-RU');
								const label = dataset.label;
			
								// Верхняя подпись (значение)
								ctx.save();
								ctx.translate(bar.x + 3, bar.y);
								ctx.rotate(-Math.PI / 2);
								ctx.fillStyle = '#000';
								ctx.font = '300 12px sans-serif';
								// ctx.textAlign = 'дуае';
								ctx.textBaseline = 'middle';
								ctx.fillText(value, 5, 0);
								ctx.restore();
			
								// Нижняя подпись (год)
								ctx.save();
								ctx.translate(bar.x, bar.y + bar.height + 10);
								ctx.rotate(-Math.PI / 2);
								ctx.fillStyle = '#444';
								ctx.font = '10px sans-serif';
								ctx.textAlign = 'right';
								ctx.textBaseline = 'middle';
								ctx.fillText(label, 0, 0);
								ctx.restore();
							});
						});
					},
				};
			
				const allValues = data.datasets.flatMap((ds) => ds.data);
				const minValue = Math.min(...allValues);
			
				// Вычислим отступ, например, 5% от минимального значения
				const bottomOffset = minValue * 0.05;
			
				const config = {
					type: 'bar',
					data: data,
					options: {
						responsive: false,
						animation: false,
						layout: {
							padding: {
								// top: 50,
								// bottom: 110,
							},
						},
						plugins: {
							tooltip: {
								callbacks: {
									label: function (context) {
										const value = context.raw.toLocaleString('ru-RU');
										return `${context.dataset.label}: ${value} чел`;
									},
								},
							},
							// legend: false,
						},
						scales: {
							x: {
								stacked: false,
								// categoryPercentage: 0.8, // 1 = все пространство, меньше — уже группы
								// barPercentage: 1.6,
								ticks: {
									padding: 35, // ← отступ между осью и подписью
								},
							},
							y: {
								display: false, // ← отключает ось
								suggestedMin: 1000000, // опускает базу графика
								min: 0,
								stacked: false,
								grace: '50%',
								// suggestedMin: minValue - bottomOffset + 1000000,
								ticks: {
									callback: function (value) {
										return value.toLocaleString('ru-RU');
									},
								},
							},
						},
					},
					plugins: [topBottomLabelsPlugin],
				};
			
				new Chart(document.getElementById('myChart').getContext('2d'), config);
			});
		</script>
	</body>
</html>